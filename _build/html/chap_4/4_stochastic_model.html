
<!DOCTYPE html>


<html lang="ja" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4. 確率モデル &#8212; Mathematical Modeling and Simulation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=1cf7f4d9"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/translations.js?v=91613774"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chap_4/4_stochastic_model';</script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="5. 微分方程式モデル" href="../chap_5/5_diff_eq.html" />
    <link rel="prev" title="3. カーブフィッティング" href="../chap_3/3_curve_fitting.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="ja"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Mathematical Modeling and Simulation - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Mathematical Modeling and Simulation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="検索" aria-label="検索" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">検索</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chap_1/1_introduction.html">1. イントロダクション</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap_2/2_environment.html">2. プログラミングの準備</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap_3/3_curve_fitting.html">3. カーブフィッティング</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">4. 確率モデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap_5/5_diff_eq.html">5. 微分方程式モデル</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../reference.html">参考文献リスト</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/tnarizuka/modeling_simulation" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="ソースリポジトリ"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/tnarizuka/modeling_simulation/issues/new?title=Issue%20on%20page%20%2Fchap_4/4_stochastic_model.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="問題を報告"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="このページをダウンロード">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chap_4/4_stochastic_model.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="ソースファイルをダウンロード"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="PDFに印刷"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="全画面モード"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="検索" aria-label="検索" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>確率モデル</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> 目次 </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">4.1. 乱数の生成</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">4.1.1. 一様乱数</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">線形合同法</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">より性能の良い一様乱数生成アルゴリズム</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">4.1.2. 任意の確率分布に従う乱数</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">逆関数法</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#box-muller">Box-Muller法（正規分布）</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">複雑な確率分布の場合</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">4.2. ベルヌーイ過程</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">4.2.1. 二項分布</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">4.2.2. ポアソン分布</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">4.2.3. 演習問題</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">4.3. 大数の法則と中心極限定理</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">4.3.1. 大数の法則</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">ベルヌーイ過程の場合</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">大数の法則（一般の場合）</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">4.3.2. 中心極限定理</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">ベルヌーイ分布の場合</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">指数分布の場合</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">4.3.3. サイコロを振る実験</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">4.4. マルコフ連鎖</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">4.4.1. マルコフ連鎖の定式化</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">遷移確率</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">状態ベクトル</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">マルコフ連鎖の定常状態</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">4.4.2. マルコフ連鎖の例</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">具体例</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">応用例</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python">4.4.3. Pythonによる実装</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">4.4.4. 演習問題</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><span class="section-number">4. </span>確率モデル<a class="headerlink" href="#id1" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">bernoulli</span><span class="p">,</span> <span class="n">binom</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">poisson</span><span class="p">,</span> <span class="n">expon</span>

<span class="c1"># 日本語フォントの設定（Mac:&#39;Hiragino Sans&#39;, Windows:&#39;MS Gothic&#39;）</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;MS Gothic&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>本章の内容は，文献<span id="id2">[<a class="reference internal" href="../reference.html#id6" title="小高知宏. Pythonによる数値計算とシミュレーション. オーム社, 2018.">4</a>, <a class="reference internal" href="../reference.html#id7" title="東京大学教養学部統計学教室編. 自然科学の統計学. 東京大学出版会, 2019.">5</a>]</span> を参考にしている．</p>
<!-- ## 確率モデルとは？ -->
<p>確率モデルとは，数理モデルの変数が確率変数となっているモデルであり，自然現象から社会現象まで様々な現象の記述に用いられる．
例えば，コイン投げは，表と裏が一定の確率で出るという数理モデルで記述できる．
また，株価の変動は，毎時刻ごとに株価の上がり幅と下がり幅が確率的に決まるようなモデル（ランダムウォーク）によって記述することができる．
本章では，確率モデルを用いたシミュレーションで必要な乱数について述べた後，確率モデルにおいて重要となる大数の法則と中心極限定理，そしてランダムウォークについて説明する．</p>
<section id="id3">
<h2><span class="section-number">4.1. </span>乱数の生成<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<p>ある数列が与えられたとき，数の並び方に規則性や周期性がない場合，この数列の各要素を<strong>乱数</strong>と呼ぶ．
乱数を生成するにはいくつかの方法がある．
例えば，サイコロを振って出た目を記録するだけでも，1〜6の数値から成る乱数を生成することができる．
また，カオスや量子力学などの物理現象を利用した乱数は<strong>物理乱数</strong>と呼ばれ，規則性や周期性がない真の乱数として研究されている．</p>
<p>一方，コンピュータ上でアルゴリズムにしたがって乱数を生成する方法もある．
このように生成された乱数は<strong>疑似乱数</strong>と呼ばれる．
疑似乱数はアルゴリズム次第で十分にランダムに見える値を高速に生成することができるため，シミュレーションにおいて役立つ．
一方，疑似乱数はアルゴリズムが分かれば値を予測することができてしまう，ある種の周期性が現れてしまう，などの欠点があるため，これを解決するための様々なアルゴリズムが提案されている．</p>
<section id="id4">
<h3><span class="section-number">4.1.1. </span>一様乱数<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>乱数の中で最も基本的なものは，ある範囲の値が同じ確率で出現する<strong>一様乱数</strong>である．
一様乱数は，一様分布に従う確率変数の実現値と捉えることができ，様々な確率モデルの構築に用いられる．
また，任意の確率分布に従う乱数を生成するためにも不可欠である．</p>
<section id="id5">
<h4>線形合同法<a class="headerlink" href="#id5" title="Link to this heading">#</a></h4>
<p>一様乱数を生成するアルゴリズムの中で，最も基本的なものが<strong>線形合同法</strong>である．
線形合同法にはいくつかの問題があるため，精度が求められる大規模なシミュレーションには使われないが，手軽に乱数を生成したりアルゴリズムの基礎を理解するためには便利である．</p>
<div class="admonition- admonition">
<p class="admonition-title">線形合同法のアルゴリズム</p>
<ol class="arabic">
<li><p>以下の大小関係を満たすように整数 <span class="math notranslate nohighlight">\( a, b, M \)</span> を決める：</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    0 &lt; a &lt; M\\
    0 \leq b &lt; M
   \end{split}\]</div>
</li>
<li><p>乱数列の初期値 <span class="math notranslate nohighlight">\( x_0 \)</span> を決める（乱数の<strong>シード</strong>と呼ぶ）．</p></li>
<li><p>以下の漸化式によって乱数列 <span class="math notranslate nohighlight">\( \{x_n\} \)</span> を生成する：</p>
<div class="math notranslate nohighlight">
\[
    x_{n+1} = (ax_{n} + b) \% M
    \]</div>
<p>ここで，<span class="math notranslate nohighlight">\( \% \)</span> は余りを求める演算子を表す．</p>
</li>
</ol>
</div>
<p>以上のアルゴリズムを用いると，<span class="math notranslate nohighlight">\( 0 \)</span> 以上 <span class="math notranslate nohighlight">\( M-1 \)</span> 以下の一様乱数列が得られる．
線形合同法によって得られた一様乱数には，実用的には問題も多く，例えば<span class="math notranslate nohighlight">\( M \)</span> が偶数の場合には偶数と奇数が交互に出現してしまう．
また，同じ値からは同じ乱数列が得られるので，乱数列が必ず周期を持ってしまう．
特に，<span class="math notranslate nohighlight">\( a, b, M \)</span> がいくつかの条件を満たすと，最大周期が <span class="math notranslate nohighlight">\( M \)</span> となることが知られているため<span id="id6">[<a class="reference internal" href="../reference.html#id7" title="東京大学教養学部統計学教室編. 自然科学の統計学. 東京大学出版会, 2019.">5</a>]</span>，良い乱数を生成するためには条件を満たした上で <span class="math notranslate nohighlight">\( M \)</span> を大きく取る必要がある．
例えば，<span class="math notranslate nohighlight">\( M=2^{32},\ a=1664525,\ b=1013904223 \)</span> の場合には，最大周期が <span class="math notranslate nohighlight">\( 2^{32} \)</span> となる．</p>
<p><strong>Pythonでの実装</strong></p>
<p>まず，アルゴリズムに従って素朴に実装すると以下のようになる．</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 10個の一様乱数を生成する</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">1664525</span><span class="p">,</span> <span class="mi">1013904223</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span>

<span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[         0 1013904223 1196435762 3519870697 2868466484 1649599747
 2670642822 1476291629 2748932008 2180890343 2498801434 3421909937
 3167820124 2636375307 3801544430   28987765 2210837584 3039689583
 1338634754 1649346937 2768872580 2254235155 2326606934 1719328701
 1061592568   53332215 1140036074 4224358465 2629538988 1946028059
  573775550 1473591045   95141024 1592739711 1618554578 4257218569
 2685635028 2617994019  740185638 4194465613 2426187848  967350023
  366635194 2557108433 3503432700  353185579  706247310  408928405
 1855199472 1263785871 2223693730  594074265  684458788 3868161075
 1929325558  166605533 2640352920 1798252823 2071081866  171871585
 2087307084  698505787 3647212126  634580517 1956956480 2017242015
 1181484146 1221761321 3441954932  962199875  571258310 3352760941
 3763818728 1371701031 1288172122 2012225009 3960962716 4082010443
 1249037870 3840393141 3947023760 3754607535 2143919426 1774599097
 1818014148  136057427 2672030614  798365181 2575687480  732141879
 2569577770 1449661057 3853535724 1541586011 2732705278 3432461637
  320021984 2287935423  697346578 2555167305 2262755092]
</pre></div>
</div>
</div>
</div>
<p>次に，<span class="math notranslate nohighlight">\( x_{\mathrm{min}} \)</span> 以上 <span class="math notranslate nohighlight">\( x_{\mathrm{max}} \)</span> 以下の一様乱数を生成する汎用的な関数を作成する．</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 線形合同法により[0, 1)の一様乱数を生成する</span>
<span class="k">def</span> <span class="nf">generagte_rand_u</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">umin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">umax</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">1664525</span><span class="p">,</span> <span class="mi">1013904223</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span>

    <span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">seed</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span><span class="p">)</span>
    
    <span class="c1"># [umin, umax)の範囲に変換して返す</span>
    <span class="k">return</span> <span class="n">umin</span> <span class="o">+</span> <span class="p">(</span><span class="n">umax</span> <span class="o">-</span> <span class="n">umin</span><span class="p">)</span> <span class="o">*</span> <span class="n">U</span> <span class="o">/</span> <span class="n">M</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span> <span class="o">=</span> <span class="n">generagte_rand_u</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">umin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">umax</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 乱数列の相関を調べる</span>
<span class="n">U2</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">U2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">U2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6ae2a076e2ff53333e4a8bd86a649691de4d046f634d88c7a41af71a4b195ec0.png" src="../_images/6ae2a076e2ff53333e4a8bd86a649691de4d046f634d88c7a41af71a4b195ec0.png" />
</div>
</div>
</section>
<section id="id7">
<h4>より性能の良い一様乱数生成アルゴリズム<a class="headerlink" href="#id7" title="Link to this heading">#</a></h4>
<p>線形合同法は，周期性の問題などがあるため，実用的にはより性能の良いアルゴリズムが用いられる．
例えば，NumpyやSciPyでは，高速で長い周期を持つ一様乱数を生成するために，<a class="reference external" href="http://www.math.sci.hiroshima-u.ac.jp/m-mat/TEACH/ichimura-sho-koen.pdf">メルセンヌ・ツイスタ</a>やPCG64などのアルゴリズムを選ぶことができる．</p>
<p>※ ライブラリのバージョンアップによって変わる可能性がある．</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Scipyを用いて[0, 1)の一様乱数を生成する</span>
<span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.71343349, 0.76172479, 0.84901057, 0.93015121, 0.32869497,
       0.02596545, 0.88018555, 0.51275695, 0.53515421, 0.17065516])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Numpyを用いて[0, 1)の一様乱数を生成する</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span> <span class="c1"># シードを123に設定</span>
<span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.68235186, 0.05382102, 0.22035987, 0.18437181, 0.1759059 ,
       0.81209451, 0.923345  , 0.2765744 , 0.81975456, 0.88989269])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id8">
<h3><span class="section-number">4.1.2. </span>任意の確率分布に従う乱数<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<section id="id9">
<h4>逆関数法<a class="headerlink" href="#id9" title="Link to this heading">#</a></h4>
<p>ある確率分布に従う乱数を生成したいとする．
もし，求めたい確率分布について，その累積分布関数の逆関数が求まるならば，以下の<strong>逆関数法</strong>が適用できる．</p>
<div class="admonition- admonition">
<p class="admonition-title">逆関数法のアルゴリズム</p>
<ol class="arabic simple">
<li><p>求めたい確率分布の累積分布関数 <span class="math notranslate nohighlight">\( F(x) \)</span> を求める．</p></li>
<li><p><span class="math notranslate nohighlight">\( F(x) \)</span> の逆関数 <span class="math notranslate nohighlight">\( F^{-1} \)</span> を計算する．</p></li>
<li><p><span class="math notranslate nohighlight">\( [0, 1) \)</span> の一様乱数 <span class="math notranslate nohighlight">\( U \)</span> に対し， <span class="math notranslate nohighlight">\( F^{-1}(U) \)</span> は求めたい確率分布に従う乱数である．</p></li>
</ol>
</div>
<div class="dropdown admonition">
<p class="admonition-title">逆関数法の証明</p>
<p><span class="math notranslate nohighlight">\( [0, 1] \)</span> の範囲の一様分布に従う確率変数（一様乱数）を <span class="math notranslate nohighlight">\( U \)</span> とすると，その累積分布関数は</p>
<div class="math notranslate nohighlight">
\[
    P(U \leq u) = u
\]</div>
<p>と表される．
ここで，求めたい確率分布の累積分布関数を <span class="math notranslate nohighlight">\( F(x) \)</span> とし，その逆関数 <span class="math notranslate nohighlight">\( F^{-1} \)</span> が求まったとする．
このとき，上の式は</p>
<div class="math notranslate nohighlight">
\[
    P(F^{-1}(U) \leq F^{-1}(u)) = u
\]</div>
<p>と変形できる．
よって，<span class="math notranslate nohighlight">\( F^{-1}(u) = x \)</span> と変数変換すれば，<span class="math notranslate nohighlight">\( u = F(x) \)</span> であるので，</p>
<div class="math notranslate nohighlight">
\[
    P(F^{-1}(U) \leq x) = F(x)
\]</div>
<p>を得る．
以上より，一様乱数 <span class="math notranslate nohighlight">\( U \)</span> に対して，新たな確率変数を <span class="math notranslate nohighlight">\( X=F^{-1}(U) \)</span> と定義すると，<span class="math notranslate nohighlight">\( X \)</span> の累積分布関数は求めたい確率分布の累積分布関数 <span class="math notranslate nohighlight">\( F(x) \)</span> になる．</p>
</div>
<p><strong>例）指数分布</strong></p>
<p>指数分布の確率密度関数は以下のように与えられる：</p>
<div class="math notranslate nohighlight">
\[
    f(x) = \frac{1}{\lambda} e^{-\frac{x}{\lambda}}
\]</div>
<p>よって，その累積分布関数は</p>
<div class="math notranslate nohighlight">
\[
    F(x) =  1 - e^{-\frac{x}{\lambda}}
\]</div>
<p>となり，その逆関数は <span class="math notranslate nohighlight">\( F(x)=u \)</span> と置くと，</p>
<div class="math notranslate nohighlight">
\[
    F^{-1}(u) = -\mu \log(1-u)  
\]</div>
<p>と求まる．
これより，[0, 1)の一様乱数 <span class="math notranslate nohighlight">\( u \)</span> に対して，<span class="math notranslate nohighlight">\( -\mu \log(1-u) \)</span> は指数分布に従うことが分かる．</p>
<p>以下は，線形合同法を用いて生成した一様乱数から指数乱数を生成する例である．</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 線形合同法で[0, 1)の一様乱数を生成する</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">generagte_rand_u</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">umin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">umax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 逆関数法で指数乱数に変換する</span>
<span class="n">lmd</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># 指数分布のパラメータ</span>
<span class="n">R_exp</span> <span class="o">=</span> <span class="o">-</span><span class="n">lmd</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">U</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 生成した指数乱数からヒストグラムを描画する</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ret</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">R_exp</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="c1"># パラメータlmdの指数分布を描画する</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">expon</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">lmd</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$ x $&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;確率密度 $ f(x) $&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;確率密度 $ f(x) $&#39;)
</pre></div>
</div>
<img alt="../_images/34db408c7cc702a3ef00a356ab1698653272379f58a047a15737a4503071fb2c.png" src="../_images/34db408c7cc702a3ef00a356ab1698653272379f58a047a15737a4503071fb2c.png" />
</div>
</div>
</section>
<section id="box-muller">
<h4>Box-Muller法（正規分布）<a class="headerlink" href="#box-muller" title="Link to this heading">#</a></h4>
<p>正規分布の場合は，中心極限定理（後述）を用いた方法やボックス・ミュラー法が知られている．
ボックスミュラー法は，<span class="math notranslate nohighlight">\( [0, 1) \)</span> の一様乱数 <span class="math notranslate nohighlight">\( U_{1},\ U_{2} \)</span> から標準正規分布に従う正規乱数 <span class="math notranslate nohighlight">\( Z_{1},\ Z_{2} \)</span> を生成することができる．</p>
<div class="admonition- admonition">
<p class="admonition-title">ボックスミュラー法のアルゴリズム</p>
<ol class="arabic">
<li><p><span class="math notranslate nohighlight">\( [0, 1) \)</span> の一様乱数 <span class="math notranslate nohighlight">\( U_1, U_2 \)</span> を生成する．</p></li>
<li><p>以下の式で一様乱数を変換する：</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    Z_1 &amp;= \sqrt{-2 \log U_1} \cos(2 \pi U_2)\\
    Z_2 &amp;= \sqrt{-2 \log U_1} \sin(2 \pi U_2)
    \end{align*}\]</div>
<p><span class="math notranslate nohighlight">\( Z_1, Z_2 \)</span> は標準正規分布に従う．</p>
</li>
</ol>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 線形合同法で[0, 1)の一様乱数を生成する</span>
<span class="n">U1</span> <span class="o">=</span> <span class="n">generagte_rand_u</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">umin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">umax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">U2</span> <span class="o">=</span> <span class="n">generagte_rand_u</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">umin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">umax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Box-Muller法で正規乱数に変換する</span>
<span class="n">Z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">U1</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">U2</span><span class="p">)</span>
<span class="n">Z2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">U1</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">U2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># 生成した乱数によるヒストグラムの描画</span>
<span class="n">ret1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="c1"># 標準正規分布の描画</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$ x $&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;確率密度 $ f(x) $&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;確率密度 $ f(x) $&#39;)
</pre></div>
</div>
<img alt="../_images/2cd6b34b84076f6ae562b8fb0167e489f48ecdca5032ec1802d7a954dfd21641.png" src="../_images/2cd6b34b84076f6ae562b8fb0167e489f48ecdca5032ec1802d7a954dfd21641.png" />
</div>
</div>
</section>
<section id="id10">
<h4>複雑な確率分布の場合<a class="headerlink" href="#id10" title="Link to this heading">#</a></h4>
<p>逆関数法は累積分布関数の逆関数が求まる場合にしか適用できなかったが，どんな確率分布にも適用できる方法として，<a class="reference external" href="https://en.wikipedia.org/wiki/Rejection_sampling">棄却法</a>がある．
また，マルコフ連鎖に基づいて任意の確率分布に従う乱数を生成するマルコフ連鎖モンテカルロ法（MCMC）は，主にベイズ推定を始めとして様々な分野で用いられている．</p>
</section>
</section>
</section>
<section id="id11">
<h2><span class="section-number">4.2. </span>ベルヌーイ過程<a class="headerlink" href="#id11" title="Link to this heading">#</a></h2>
<p>以下の条件を満たす試行を<strong>ベルヌーイ試行</strong>と呼ぶ：</p>
<ul class="simple">
<li><p>1回の試行において，起こりうる事象が2種類しかない</p></li>
<li><p>各事象が起こる確率は一定である</p></li>
<li><p>各試行は独立である</p></li>
</ul>
<p>通常は，2種類の事象をそれぞれ成功（1），失敗（0）に対応付けた確率変数 <span class="math notranslate nohighlight">\( U \)</span> を考え，成功確率を <span class="math notranslate nohighlight">\( p \)</span>，失敗確率を <span class="math notranslate nohighlight">\( 1-p \)</span> とする．
このとき，確率変数 <span class="math notranslate nohighlight">\( U \)</span> の従う確率分布は</p>
<div class="math notranslate nohighlight">
\[
	P(U=u) = p^{u}(1-p)^{1-u} 
\]</div>
<p>と表され，これを<strong>ベルヌーイ分布</strong>と呼ぶ．
例えば，コイン投げは典型的なベルヌーイ試行であり，コインを１回投げたときの確率分布はベルヌーイ分布である．</p>
<p>ベルヌーイ試行を繰り返すとき，これを<strong>ベルヌーイ過程</strong>と呼ぶ．
多くの基本的な確率分布はベルヌーイ過程を基に導くことができる．
以下にいくつかの例を示す．</p>
<ul class="simple">
<li><p><strong>二項分布</strong>：ベルヌーイ過程において，成功回数が従う確率分布．</p></li>
<li><p><strong>正規分布</strong>：ベルヌーイ過程において，試行回数 <span class="math notranslate nohighlight">\( n \)</span> が十分大きい場合の成功回数の分布．</p></li>
<li><p><strong>幾何分布</strong>：ベルヌーイ過程において，初めて成功するまでの失敗回数が従う確率分布．</p></li>
<li><p><strong>負の二項分布</strong>：ベルヌーイ過程において， <span class="math notranslate nohighlight">\( r \)</span> 回目の成功が起こるまでの失敗回数が従う確率分布．</p></li>
<li><p><strong>ポアソン分布</strong>：ベルヌーイ過程において，成功確率 <span class="math notranslate nohighlight">\( p \)</span> が小さく，試行回数 <span class="math notranslate nohighlight">\( n \)</span> が大きいときに <span class="math notranslate nohighlight">\( np=一定 \)</span> の条件の下で成功回数が従う確率分布．</p></li>
</ul>
<section id="id12">
<h3><span class="section-number">4.2.1. </span>二項分布<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<p>ベルヌーイ試行を <span class="math notranslate nohighlight">\( n \)</span> 回繰り返すとき，成功回数 <span class="math notranslate nohighlight">\( X=\displaystyle\sum_{i=1}^{n} U_{i} \)</span> を新たな確率変数とする．
このとき，成功が <span class="math notranslate nohighlight">\( x \)</span> 回，失敗が <span class="math notranslate nohighlight">\( n-x \)</span> 回生じたとすると，その確率分布は<strong>二項分布</strong></p>
<div class="math notranslate nohighlight">
\[
	f(x) = \binom{n}{x}p^{x}(1-p)^{n-x}
\]</div>
<p>で与えられる．
この式において，<span class="math notranslate nohighlight">\( p^{x}(1-p)^{n-x} \)</span> は成功が <span class="math notranslate nohighlight">\( x \)</span> 回，失敗が <span class="math notranslate nohighlight">\( n-x \)</span> 回生じる確率を意味する．
また，<span class="math notranslate nohighlight">\( \displaystyle\binom{n}{x} \)</span> は <span class="math notranslate nohighlight">\( n \)</span> 個から <span class="math notranslate nohighlight">\( x \)</span> を取り出す組み合わせの数 <span class="math notranslate nohighlight">\( _{n}C_{x} \)</span> を表し，<span class="math notranslate nohighlight">\( n \)</span> 回の中で何回目に成功するかの場合の数に対応する．
なお，<span class="math notranslate nohighlight">\( n=1 \)</span> の場合はベルヌーイ分布に対応する．</p>
<p>二項分布は試行回数 <span class="math notranslate nohighlight">\( n \)</span> と成功確率 <span class="math notranslate nohighlight">\( p \)</span> がパラメータであり，これらによって分布の形が決まる．</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 成功確率pを変化させた場合の二項分布の変化</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Binomial ($n=10, p=</span><span class="si">%s</span><span class="s1">$)&#39;</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;成功回数 $x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;確率 $f(x)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a743ae92bb59a1a2857a703358171678f7e48883c29dbc0288bde6f6449ed526.png" src="../_images/a743ae92bb59a1a2857a703358171678f7e48883c29dbc0288bde6f6449ed526.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 試行回数nを変化させた場合の二項分布の変化</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.2</span><span class="p">),</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Binomial ($n=</span><span class="si">%s</span><span class="s1">, p=0.2$)&#39;</span> <span class="o">%</span> <span class="n">n</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;成功回数 $x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;確率 $f(x)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f995531250b2aae7364ba8e151753b28edecef60cf4b8f7fe75ad7f94d6eb785.png" src="../_images/f995531250b2aae7364ba8e151753b28edecef60cf4b8f7fe75ad7f94d6eb785.png" />
</div>
</div>
</section>
<section id="id13">
<h3><span class="section-number">4.2.2. </span>ポアソン分布<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<p>ベルヌーイ試行を <span class="math notranslate nohighlight">\( n \)</span> 回繰り返すとき，成功確率 <span class="math notranslate nohighlight">\( p \)</span> が小さく，かつ試行回数 <span class="math notranslate nohighlight">\( n \)</span> が大きい極限を考える．
ただし，極限を取る際に平均値が一定値 <span class="math notranslate nohighlight">\( np=\mu \)</span> になるようにする．
このような条件で成功回数 <span class="math notranslate nohighlight">\( X \)</span> が従う分布は，二項分布の式に <span class="math notranslate nohighlight">\( np=\mu \)</span> を代入し，極限 <span class="math notranslate nohighlight">\( p\to 0,\ n\to \infty \)</span> を取ることで</p>
<div class="math notranslate nohighlight">
\[
	f(x) = \frac{\mu^{x}}{x!} \mathrm{e}^{-\mu}
\]</div>
<p>と求まる．
これを<strong>ポアソン分布</strong>と呼ぶ．
ポアソン分布は1つのパラメータ <span class="math notranslate nohighlight">\( \mu \)</span> だけで特徴づけられ，期待値と分散はともに <span class="math notranslate nohighlight">\( \mu \)</span> となる．</p>
<p>ポアソン分布は，一定の期間内（例えば１時間や１日）に，稀な現象（<span class="math notranslate nohighlight">\( p\to 0 \)</span>）を多数回試行（<span class="math notranslate nohighlight">\( n\to \infty \)</span>）した場合にその発生回数が従う分布である．
ポアソン分布が現れる例は無数にあり，「1日のコンビニの来店客数」，「1日の交通事故件数」，「1分間の放射性元素の崩壊数」，「1ヶ月の有感地震の回数」，「サッカーの試合における90分間の得点数」などは典型例である．</p>
<p>以下は <span class="math notranslate nohighlight">\( np=5 \)</span> に保って <span class="math notranslate nohighlight">\( n \)</span> を大きく，<span class="math notranslate nohighlight">\( p \)</span> を小さくしたときの二項分布（折れ線グラフ）と <span class="math notranslate nohighlight">\( \mu=5 \)</span> のポアソン分布（棒グラフ）の比較である．
<span class="math notranslate nohighlight">\( n=80,\ p=1/16 \)</span> になると，二項分布とポアソン分布はほとんど一致していることが分かる．</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># ポアソン分布</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Poisson ($\mu=5$)&#39;</span><span class="p">)</span>

<span class="c1"># 二項分布</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="mi">10</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="n">i</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;o--&#39;</span><span class="p">,</span> <span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Binomial ($n=</span><span class="si">%s</span><span class="s1">, p=1/</span><span class="si">%s</span><span class="s1">$)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;成功回数 $ x $&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;確率 $f(x)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9d0cb926ce898c603a1b927c26facaec255ed91d1ef4c71b640a77046584b428.png" src="../_images/9d0cb926ce898c603a1b927c26facaec255ed91d1ef4c71b640a77046584b428.png" />
</div>
</div>
<p><strong><span class="math notranslate nohighlight">\( \mu \)</span>が大きいとき</strong></p>
<p>ポアソン分布は <span class="math notranslate nohighlight">\( \mu \)</span> を大きくすると平均と分散が共に <span class="math notranslate nohighlight">\( \mu \)</span> の正規分布に近づくことが知られている：</p>
<div class="math notranslate nohighlight">
\[
    f(x) = \frac{\mu^{x}}{x!} \mathrm{e}^{-\mu} \quad \longrightarrow \quad \frac{1}{\sqrt{2\pi\mu}} \exp\left(-\frac{(x-\mu)^2}{2\mu}\right)
\]</div>
<p>以下はパラメータ <span class="math notranslate nohighlight">\( \mu \)</span> を増加させた場合のポアソン分布（棒グラフ）と正規分布（破線）の比較である．
<span class="math notranslate nohighlight">\( \mu \)</span> が大きくなるほどポアソン分布が正規分布に近づくことが確認できる．</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">mu</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>  <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Poisson ($\mu=</span><span class="si">%s</span><span class="s1">$)&#39;</span> <span class="o">%</span> <span class="n">mu</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mu</span><span class="p">)),</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Normal ($\mu=</span><span class="si">%s</span><span class="s1">, \sigma^2=</span><span class="si">%s</span><span class="s1">$)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">mu</span><span class="p">))</span>
    
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;成功回数 $x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;確率 $f(x)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a09ccc5c4dba99c5dbf79d2278906ba37f4ba2d0ef9d085517f466bcf1477a7d.png" src="../_images/a09ccc5c4dba99c5dbf79d2278906ba37f4ba2d0ef9d085517f466bcf1477a7d.png" />
</div>
</div>
</section>
<section id="id14">
<h3><span class="section-number">4.2.3. </span>演習問題<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>二項分布の期待値が <span class="math notranslate nohighlight">\( np \)</span>，分散が <span class="math notranslate nohighlight">\( np(1-p) \)</span> となることを示せ．</p></li>
<li><p>二項分布からポアソン分布を導出せよ．</p></li>
<li><p>ポアソン分布の期待値と分散が共に <span class="math notranslate nohighlight">\( \mu \)</span> であることを示せ．</p></li>
</ol>
</section>
</section>
<section id="id15">
<h2><span class="section-number">4.3. </span>大数の法則と中心極限定理<a class="headerlink" href="#id15" title="Link to this heading">#</a></h2>
<!-- 
### ベルヌーイ試行

### 二項分布

### 大数の法則

### 中心極限定理

## ランダムウォーク --><section id="id16">
<h3><span class="section-number">4.3.1. </span>大数の法則<a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<section id="id17">
<h4>ベルヌーイ過程の場合<a class="headerlink" href="#id17" title="Link to this heading">#</a></h4>
<p>既にベルヌーイ過程における成功回数 <span class="math notranslate nohighlight">\( X=\displaystyle\sum_{i=1}^{n} U_{i} \)</span> が二項分布に従うことを見たが，ここでは <span class="math notranslate nohighlight">\( U \)</span> の標本平均（成功割合）</p>
<div class="math notranslate nohighlight">
\[
	T = \frac{X}{n} = \frac{1}{n}\displaystyle\sum_{i=1}^{n} U_{i}
\]</div>
<p>を新しい確率変数とする．
このとき， <span class="math notranslate nohighlight">\( T \)</span> の確率分布を <span class="math notranslate nohighlight">\( g(t) \)</span> とすると，<span class="math notranslate nohighlight">\( g(t) \)</span> も二項分布に従い，<span class="math notranslate nohighlight">\( g(t)=nf(nt) \)</span> の関係にある．</p>
<p>次の例は成功確率を <span class="math notranslate nohighlight">\( p=1/6 \)</span> に固定して，試行回数 <span class="math notranslate nohighlight">\( n \)</span> を大きくしたときの標本平均 <span class="math notranslate nohighlight">\( T \)</span> の確率分布である（例えば，サイコロを振って1が出た場合に <span class="math notranslate nohighlight">\( U=1 \)</span> ，それ以外の場合に <span class="math notranslate nohighlight">\( U=0 \)</span> とした場合）．
この図を見ると，<span class="math notranslate nohighlight">\( n \)</span> の増加に伴って <span class="math notranslate nohighlight">\( t=1/6 \)</span> の周りに分布が集中するとともに，高さが大きくなる様子が分かる．</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">*</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">),</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$n=</span><span class="si">%s</span><span class="s1">, p=1/6$&#39;</span> <span class="o">%</span> <span class="n">n</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;標本平均 $t$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;確率密度 $g(t)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d6c1b9639f0fe4302a7d6340603f85ca11d0bf6b7f61272edbda03a5b5d2f961.png" src="../_images/d6c1b9639f0fe4302a7d6340603f85ca11d0bf6b7f61272edbda03a5b5d2f961.png" />
</div>
</div>
<p>以上のような図の変化を数式で確認する．
まず，成功回数 <span class="math notranslate nohighlight">\( X \)</span> の期待値と分散はそれぞれ <span class="math notranslate nohighlight">\( E(X)=np,\ V(X)=np(1-p) \)</span> であるから，成功割合 <span class="math notranslate nohighlight">\( T=X/n \)</span> の期待値と分散はそれぞれ <span class="math notranslate nohighlight">\( E(T)=p,\ V(T)=p(1-p)/n \)</span> となる．
これより，成功割合 <span class="math notranslate nohighlight">\( T=X/n \)</span> の期待値は <span class="math notranslate nohighlight">\( n \)</span> に依らず一定 <span class="math notranslate nohighlight">\( p \)</span> で，分散は <span class="math notranslate nohighlight">\( n \)</span> とともに0に近づくことが分かる．
これが，成功割合 <span class="math notranslate nohighlight">\( T=X/n \)</span> の分布が試行回数 <span class="math notranslate nohighlight">\( n \)</span> の増加とともに <span class="math notranslate nohighlight">\( p \)</span> の近くに集中する理由である．</p>
<p>以上のように，ベルヌーイ過程においては，試行回数 <span class="math notranslate nohighlight">\( n\to \infty \)</span> の極限で成功割合 <span class="math notranslate nohighlight">\( T=X/n \)</span> が理論値 <span class="math notranslate nohighlight">\( p \)</span> に一致する．
このように，確率変数の標本平均が理論値に一致する性質は<strong>大数の法則</strong>と呼ばれている．</p>
</section>
<section id="id18">
<h4>大数の法則（一般の場合）<a class="headerlink" href="#id18" title="Link to this heading">#</a></h4>
<p>大数の法則は，一般の確率分布に従う確率変数列について成り立つ法則であり，以下のように表される．</p>
<div class="admonition- admonition">
<p class="admonition-title">大数の法則</p>
<p>独立同分布に従う <span class="math notranslate nohighlight">\( n \)</span> 個の確率変数 <span class="math notranslate nohighlight">\( U_{1}, U_{2},\ldots, U_{n} \)</span> に対し，それぞれの期待値（母平均）を <span class="math notranslate nohighlight">\( \mu \)</span> とする．
このとき，確率変数列の標本平均 <span class="math notranslate nohighlight">\( \displaystyle T=\frac{1}{n}\sum_{i=1}^{n}U_{i} \)</span> は <span class="math notranslate nohighlight">\( n\to\infty \)</span> で <span class="math notranslate nohighlight">\( \mu \)</span> に一致する．</p>
</div>
<p>以下は，様々な確率分布に対する大数の法則のシミュレーションである．</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="c1"># 様々な確率分布からサイズnの標本を生成する</span>
<span class="n">U_uni</span> <span class="o">=</span> <span class="n">uniform</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">N</span><span class="p">))</span> <span class="c1"># 一様分布（母平均1）</span>
<span class="n">U_norm</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>   <span class="c1"># 正規分布（母平均2）</span>
<span class="n">U_binom</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>    <span class="c1"># 二項分布（母平均3）</span>
<span class="n">U_poisson</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>       <span class="c1"># ポアソン分布（母平均4）</span>
<span class="n">U_expon</span> <span class="o">=</span> <span class="n">expon</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>        <span class="c1"># 指数分布（母平均5）</span>

<span class="c1"># 様々な標本サイズnに対して標本平均を計算</span>
<span class="n">T_uni</span><span class="p">,</span> <span class="n">T_norm</span><span class="p">,</span> <span class="n">T_binom</span><span class="p">,</span> <span class="n">T_poisson</span><span class="p">,</span> <span class="n">T_expon</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">N</span><span class="p">:</span>
    <span class="n">T_uni</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U_uni</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">T_norm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U_norm</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">T_binom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U_binom</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">T_poisson</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U_poisson</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">T_expon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U_expon</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="c1"># 標本平均の変化をプロット</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">T_uni</span><span class="p">),</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;一様分布（母平均=1）&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">T_norm</span><span class="p">),</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;正規分布（母平均=2）&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">T_binom</span><span class="p">),</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;二項分布（母平均=3）&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">T_poisson</span><span class="p">),</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ポアソン分布（母平均=4）&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">T_expon</span><span class="p">),</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;指数分布（母平均=5）&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">N</span><span class="p">));</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;標本サイズ $n$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;標本平均&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/707f26236b94b358632c8f16330f785979834e76ba41600e86baf82a9b6450d2.png" src="../_images/707f26236b94b358632c8f16330f785979834e76ba41600e86baf82a9b6450d2.png" />
</div>
</div>
</section>
</section>
<section id="id19">
<h3><span class="section-number">4.3.2. </span>中心極限定理<a class="headerlink" href="#id19" title="Link to this heading">#</a></h3>
<p>ベルヌーイ過程において，<span class="math notranslate nohighlight">\( n \)</span> 回のベルヌーイ試行を１セットとして，成功回数 <span class="math notranslate nohighlight">\( X \)</span> や成功割合（標本平均） <span class="math notranslate nohighlight">\( T \)</span> を求める．
これを何セットも繰り返すと，<span class="math notranslate nohighlight">\( X \)</span> や <span class="math notranslate nohighlight">\( T \)</span> の分布が得られ，いずれも二項分布に従うが，<span class="math notranslate nohighlight">\( n \)</span> を大きくしていくと左右非対称な分布から左右対称な分布へと変化する．
このとき，<span class="math notranslate nohighlight">\( n \)</span> を十分大きくしたときに出現する左右対称で滑らかな分布は<strong>正規分布</strong>であることが知られている．</p>
<p>以上はベルヌーイ過程の場合であるが，実は一般の確率分布に従う確率変数列についても，<span class="math notranslate nohighlight">\( n \)</span> が十分大きいとき，確率変数列の和や標本平均は正規分布に近づくことが知られている．
この性質は<strong>中心極限定理</strong>と呼ばれており，より具体的には以下のように表される．</p>
<div class="admonition- admonition">
<p class="admonition-title">中心極限定理</p>
<p>独立同分布に従う <span class="math notranslate nohighlight">\( n \)</span> 個の確率変数 <span class="math notranslate nohighlight">\( U_{1}, U_{2},\ldots, U_{n} \)</span> に対し，それぞれの母平均を <span class="math notranslate nohighlight">\( \mu \)</span>，母分散を <span class="math notranslate nohighlight">\( \sigma^2 &lt; \infty \)</span> とする．このとき，確率変数列の標本平均 <span class="math notranslate nohighlight">\( \displaystyle T=\frac{1}{n}\sum_{i=1}^{n}U_{i} \)</span> の分布 <span class="math notranslate nohighlight">\( g(t) \)</span> が <span class="math notranslate nohighlight">\( n \)</span> を大きくしたときに正規分布 <span class="math notranslate nohighlight">\( N(\mu, \sigma^{2}/n) \)</span> に近づく</p>
</div>
<section id="id20">
<h4>ベルヌーイ分布の場合<a class="headerlink" href="#id20" title="Link to this heading">#</a></h4>
<p>確率変数列 <span class="math notranslate nohighlight">\( U_{1}, U_{2},\ldots, U_{n} \)</span> が成功確率 <span class="math notranslate nohighlight">\( p \)</span> のベルヌーイ分布に従うとき，期待値は <span class="math notranslate nohighlight">\( p \)</span>，分散は <span class="math notranslate nohighlight">\( p(1-p) \)</span>である．
よって，中心極限定理によると， <span class="math notranslate nohighlight">\( U \)</span> の標本平均（成功割合）の分布は <span class="math notranslate nohighlight">\( n \)</span> を大きくしたときに正規分布 <span class="math notranslate nohighlight">\( N(p, p(1-p)/n) \)</span> に近づく．</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 標本平均を10000回計算する</span>
<span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span> <span class="c1"># ベルヌーイ試行の成功確率</span>
<span class="n">T10</span><span class="p">,</span> <span class="n">T20</span><span class="p">,</span> <span class="n">T50</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
    <span class="c1"># 確率pのベルヌーイ分布からサイズnの標本を生成</span>
    <span class="n">U10</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">bernoulli</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> 
    <span class="n">U20</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">bernoulli</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> 
    <span class="n">U50</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">bernoulli</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span> 
    
    <span class="c1"># 標本平均を計算してリストに追加</span>
    <span class="n">T10</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U10</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">T20</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U20</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">T50</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U50</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="c1"># 標本平均のヒストグラムを描画</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">T10</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">T10</span><span class="p">),</span> <span class="n">rwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$n=10$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">T20</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">T20</span><span class="p">),</span> <span class="n">rwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$n=20$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">T50</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">T50</span><span class="p">),</span> <span class="n">rwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$n=50$&#39;</span><span class="p">)</span>

<span class="c1"># 正規分布の確率密度関数を描画</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
<span class="n">gt</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">gt</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$N(p, p(1-p)/n)$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;標本平均 $ t $ &#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;確率密度 $ g(t) $ &#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/82e72dbd7d85283216434b6b40e692a471f162c16d0aeb7e34089113bd5212b4.png" src="../_images/82e72dbd7d85283216434b6b40e692a471f162c16d0aeb7e34089113bd5212b4.png" />
</div>
</div>
</section>
<section id="id21">
<h4>指数分布の場合<a class="headerlink" href="#id21" title="Link to this heading">#</a></h4>
<p>確率変数列 <span class="math notranslate nohighlight">\( U_{1}, U_{2},\ldots, U_{n} \)</span> がパラメータ <span class="math notranslate nohighlight">\( \lambda \)</span> の指数分布に従うとき，期待値は <span class="math notranslate nohighlight">\( \lambda \)</span>，分散は <span class="math notranslate nohighlight">\( \lambda^2 \)</span> である．
よって，中心極限定理によると， <span class="math notranslate nohighlight">\( U \)</span> の標本平均（成功割合）の分布は <span class="math notranslate nohighlight">\( n \)</span> を大きくしたときに正規分布 <span class="math notranslate nohighlight">\( N(\lambda, \lambda^2/n) \)</span> に近づく．</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 標本平均を10000回計算する</span>
<span class="n">lmd</span><span class="o">=</span><span class="mi">2</span>  <span class="c1"># 指数分布のパラメータ</span>
<span class="n">T3</span><span class="p">,</span> <span class="n">T10</span><span class="p">,</span> <span class="n">T50</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
    <span class="c1"># パラメータlmdのポアソン分布からサイズnの標本を生成</span>
    <span class="n">U3</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">expon</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">lmd</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> 
    <span class="n">U10</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">expon</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">lmd</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">U50</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">expon</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">lmd</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    
    <span class="c1"># 標本平均を計算してリストに追加</span>
    <span class="n">T3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U3</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>    
    <span class="n">T10</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U10</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">T50</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U50</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="c1"># 標本平均のヒストグラムを描画</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">T3</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$n=10$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">T10</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$n=20$&#39;</span><span class="p">)</span>
<span class="n">ret</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">T50</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$n=50$&#39;</span><span class="p">)</span>

<span class="c1"># 正規分布N(\mu, \sigma^2/n)の確率密度関数を描画</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">gt</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">lmd</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lmd</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">50</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">gt</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$N(\lambda, \lambda/n)$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;標本平均 $ t $ &#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;確率密度 $ g(t) $ &#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c88be68d2008809b3184c6be8936f859df073bb7afa22e32228158973c887c8f.png" src="../_images/c88be68d2008809b3184c6be8936f859df073bb7afa22e32228158973c887c8f.png" />
</div>
</div>
</section>
</section>
<section id="id22">
<h3><span class="section-number">4.3.3. </span>サイコロを振る実験<a class="headerlink" href="#id22" title="Link to this heading">#</a></h3>
<p>サイコロを振って1が出たら成功（ <span class="math notranslate nohighlight">\( U=1 \)</span> ），それ以外は失敗（ <span class="math notranslate nohighlight">\( U=0 \)</span> ）とする．
これを <span class="math notranslate nohighlight">\( n \)</span> 回繰り返すと，成功確率 <span class="math notranslate nohighlight">\( p=1/6 \)</span> のベルヌーイ過程となるので，<span class="math notranslate nohighlight">\( n \)</span> を大きくすると <span class="math notranslate nohighlight">\( U \)</span> の標本平均（1が出た割合）は理論値 <span class="math notranslate nohighlight">\( p \)</span> に近づく（大数の法則）．
また，<span class="math notranslate nohighlight">\( n \)</span> を大きくすると <span class="math notranslate nohighlight">\( U \)</span> の標本平均（1が出た割合）の分布は正規分布 <span class="math notranslate nohighlight">\( N(p, p(1-p)/n) \)</span> に近づく（中心極限定理）．
以上の性質を実際にサイコロを振る実験を行って確認せよ．</p>
<p><strong>サイコロを振る実験</strong></p>
<p>サイコロを <span class="math notranslate nohighlight">\( n \)</span> 回振ることを1セットとする．
今回の実験では，Excelの１行が1セットとなるように記録する．</p>
<ul class="simple">
<li><p>グループに分かれて5個のサイコロを何度も振り，出た目をExcelファイルに記録せよ．</p></li>
<li><p>記録する際には，50個のサイコロの出目を記録するごとに次の行に移ること．</p></li>
<li><p>50行を目安にサイコロを振ること．</p></li>
</ul>
<p><strong>サイコロ実験の集計（Excel）</strong></p>
<ul class="simple">
<li><p>1セットの試行回数が <span class="math notranslate nohighlight">\( n=10,20,50 \)</span> の場合について，各セットで1が出た割合を計算せよ．</p></li>
<li><p><span class="math notranslate nohighlight">\( n=10,20,50 \)</span> の場合について，1が出た割合のデータをcsvファイルに保存せよ．</p></li>
</ul>
<p><strong>サイコロ実験の解析（Python）</strong></p>
<ul class="simple">
<li><p>csvファイルをPandasのDataFrameに読み込め．</p></li>
<li><p><span class="math notranslate nohighlight">\( n=10,20,50 \)</span> の場合について，1が出た割合のヒストグラムを描け．</p></li>
<li><p><span class="math notranslate nohighlight">\( n=50 \)</span> の場合について，正規分布 <span class="math notranslate nohighlight">\( N(p, p(1-p)/n) \)</span> を重ね描きし，中心極限定理を確認せよ．</p></li>
</ul>
</section>
</section>
<section id="id23">
<h2><span class="section-number">4.4. </span>マルコフ連鎖<a class="headerlink" href="#id23" title="Link to this heading">#</a></h2>
<section id="id24">
<h3><span class="section-number">4.4.1. </span>マルコフ連鎖の定式化<a class="headerlink" href="#id24" title="Link to this heading">#</a></h3>
<p>ベルヌーイ過程は，１回の試行で取りうる状態が2つ（成功／失敗）だけで，それぞれの出現確率が一定値（<span class="math notranslate nohighlight">\( p,\ 1-p \)</span>）であったが，これを次のように拡張する：</p>
<ol class="arabic simple">
<li><p>各時刻で取りうる状態が離散的で2つ以上</p></li>
<li><p>次の時刻に取りうる状態が現在の状態だけに依存して決まる（<strong>マルコフ性</strong>）</p></li>
</ol>
<p>以上のような確率過程を<strong>マルコフ連鎖</strong>と呼ぶ．</p>
<section id="id25">
<h4>遷移確率<a class="headerlink" href="#id25" title="Link to this heading">#</a></h4>
<p>時刻 <span class="math notranslate nohighlight">\( t \)</span> の状態を確率変数 <span class="math notranslate nohighlight">\( U_{t} \)</span> によって表す．
<span class="math notranslate nohighlight">\( U_{t} \)</span> は離散的な状態 <span class="math notranslate nohighlight">\( \{0, 1, 2, \ldots\} \)</span> を取るものとする（取りうる状態の集合を<strong>状態空間</strong>と呼ぶ）．
このとき，マルコフ性は以下のように表される：</p>
<div class="math notranslate nohighlight">
\[
     P(U_{t+1}=j|U_{t}=i, U_{t-1}, \ldots, U_{0}) = P(U_{t+1}=j|U_{t}=i)
\]</div>
<p>これは，時刻 <span class="math notranslate nohighlight">\( t+1 \)</span> に状態 <span class="math notranslate nohighlight">\( j \)</span> を取る確率が，時刻 <span class="math notranslate nohighlight">\( t \)</span> の状態だけで決まることを表している．
以下ではこの確率を</p>
<div class="math notranslate nohighlight">
\[ 
    P(U_{t+1}=j|U_{t}=i) = p_{ij} 
\]</div>
<p>と表し，これを状態 <span class="math notranslate nohighlight">\( i \)</span> から <span class="math notranslate nohighlight">\( j \)</span> への<strong>遷移確率</strong>と呼ぶ．
また，遷移確率 <span class="math notranslate nohighlight">\( p_{ij} \)</span> を <span class="math notranslate nohighlight">\( (i,j) \)</span> 成分とする行列を<strong>遷移確率行列</strong>と呼び，<span class="math notranslate nohighlight">\( P \)</span> と表す．
なお，遷移確率は時刻 <span class="math notranslate nohighlight">\( t \)</span> に依らず一定であるとする（これを時間的に一様なマルコフ連鎖と呼ぶ）．
マルコフ連鎖は，各状態間を遷移確率に従って次々に移動するようなイメージを持つと理解しやすい．</p>
<p>マルコフ連鎖の具体例として，状態空間が <span class="math notranslate nohighlight">\( S=\{0, 1, 2\} \)</span> の場合を考える．
<a class="reference internal" href="#fig-markov-chain"><span class="std std-numref">図 4.1</span></a>は，状態間の遷移確率を可視化したもので，<strong>状態遷移図</strong>と呼ばれる．
この場合の遷移確率行列は次のように与えられる：</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    P = \begin{pmatrix}
        p_{00} &amp; p_{01} &amp; p_{02} \\
        p_{10} &amp; p_{11} &amp; p_{12} \\
        p_{20} &amp; p_{21} &amp; p_{22}
    \end{pmatrix}
    = \begin{pmatrix}
        0.1 &amp; 0.3 &amp; 0.6 \\
        0.2 &amp; 0.7 &amp; 0.1 \\
        0.3 &amp; 0.2 &amp; 0.5
    \end{pmatrix}
\end{split}\]</div>
<p>ここで，遷移確率行列は各行の和が必ず1になることに注意する．
これは，次の時刻で必ずいずれかの状態に遷移することを意味している．</p>
<figure class="align-default" id="fig-markov-chain">
<a class="reference internal image-reference" href="../_images/markov_chain.png"><img alt="../_images/markov_chain.png" src="../_images/markov_chain.png" style="height: 250px;" /></a>
<figcaption>
<p><span class="caption-number">図 4.1 </span><span class="caption-text">マルコフ連鎖の状態遷移図</span><a class="headerlink" href="#fig-markov-chain" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="id26">
<h4>状態ベクトル<a class="headerlink" href="#id26" title="Link to this heading">#</a></h4>
<p>時刻 <span class="math notranslate nohighlight">\( t \)</span> に状態 <span class="math notranslate nohighlight">\( i \)</span> を取る確率を</p>
<div class="math notranslate nohighlight">
\[ 
    P(U_{t}=i)=w^{(t)}_{i} 
\]</div>
<p>と表し，全状態を並べたベクトル <span class="math notranslate nohighlight">\( \boldsymbol{w}_{t} \)</span> を<strong>状態ベクトル</strong>と呼ぶ．
状態ベクトルは確率分布を表し，3状態の場合は <span class="math notranslate nohighlight">\( \boldsymbol{w}_{t} = [w^{(t)}_{0}, w^{(t)}_{1}, w^{(t)}_{2}] \)</span> と表される．
（※ ベルヌーイ過程の場合，状態ベクトルはベルヌーイ分布を意味する．）</p>
<p>時刻 <span class="math notranslate nohighlight">\( t+1 \)</span> の状態ベクトル <span class="math notranslate nohighlight">\( \boldsymbol{w}_{t+1} \)</span> は，時刻 <span class="math notranslate nohighlight">\( t \)</span> の状態ベクトル <span class="math notranslate nohighlight">\( \boldsymbol{w}_{t} \)</span> と遷移確率行列 <span class="math notranslate nohighlight">\( P \)</span> を用いて</p>
<div class="math notranslate nohighlight">
\[
    \boldsymbol{w}_{t+1} = \boldsymbol{w}_{t}P  
\]</div>
<p>と表すことができる．
すなわち，状態ベクトルは遷移確率行列をかけることで次の時刻の状態ベクトルに変化する．
これより，初期状態ベクトル <span class="math notranslate nohighlight">\( \boldsymbol{w}_{0} \)</span> が与えられたとき，時刻 <span class="math notranslate nohighlight">\( t \)</span> の状態ベクトルは</p>
<div class="math notranslate nohighlight">
\[
    \boldsymbol{w}_{t} = \boldsymbol{w}_{0}P^{t}
\]</div>
<p>と表される．</p>
<p>例えば，<a class="reference internal" href="#fig-markov-chain"><span class="std std-numref">図 4.1</span></a>の場合について，初期状態ベクトル <span class="math notranslate nohighlight">\( \boldsymbol{w}_{0} = [1, 0, 0] \)</span> が与えられたとき，時刻 <span class="math notranslate nohighlight">\( 1 \)</span> の状態ベクトルは次のようになる：</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \boldsymbol{w}_{1} = \boldsymbol{w}_{0}P = [1, 0, 0] \begin{pmatrix}
        0.1 &amp; 0.3 &amp; 0.6 \\
        0.2 &amp; 0.7 &amp; 0.1 \\
        0.3 &amp; 0.2 &amp; 0.5
    \end{pmatrix} = [0.1, 0.3, 0.6]
\end{split}\]</div>
</section>
<section id="id27">
<h4>マルコフ連鎖の定常状態<a class="headerlink" href="#id27" title="Link to this heading">#</a></h4>
<p>状態ベクトルは遷移を繰り返すことによって変化していくが，もしそれ以上変化しなくなった場合，これを<strong>定常状態</strong>と呼ぶ．
定常状態の状態ベクトル <span class="math notranslate nohighlight">\( \boldsymbol{w} \)</span> は遷移確率行列 <span class="math notranslate nohighlight">\( P \)</span> をかけても変化しないので，</p>
<div class="math notranslate nohighlight">
\[
     \boldsymbol{w}P = \boldsymbol{w}
\]</div>
<p>という式を満たす．
ここで，この式の両辺の転置を取ると，</p>
<div class="math notranslate nohighlight">
\[
    P^{\top}\boldsymbol{w}^{\top} = \boldsymbol{w}^{\top}
\]</div>
<p>となることから，<span class="math notranslate nohighlight">\( \boldsymbol{w}^{\top} \)</span> は行列<span class="math notranslate nohighlight">\( P^{\top} \)</span>の固有値1に対応する固有ベクトルであることが分かる．
なお，行列 <span class="math notranslate nohighlight">\( P^{\top} \)</span> が固有値1を持つことは，以下の固有方程式を解くことで確認できる：</p>
<div class="math notranslate nohighlight">
\[
    |P^{\top} - \lambda I| = 0
\]</div>
<div class="dropdown admonition">
<p class="admonition-title">固有方程式の導出</p>
<p>以下の固有値問題を考える：</p>
<div class="math notranslate nohighlight">
\[
    P^{\top}\boldsymbol{w}^{\top} = \lambda \boldsymbol{w}^{\top}
\]</div>
<p>単位行列を <span class="math notranslate nohighlight">\( I \)</span> とすると，上式は次のように変形できる：</p>
<div class="amsmath math notranslate nohighlight" id="equation-f78ae89b-d182-497f-81c2-a628b9b3ddfb">
<span class="eqno">(4.1)<a class="headerlink" href="#equation-f78ae89b-d182-497f-81c2-a628b9b3ddfb" title="Permalink to this equation">#</a></span>\[\begin{align}
    P^{\top}\boldsymbol{w}^{\top} &amp;= \lambda I \boldsymbol{w}^{\top}\\
    (P^{\top} - \lambda I)\boldsymbol{w}^{\top} &amp;= 0
\end{align}\]</div>
<p>ここで，<span class="math notranslate nohighlight">\( P^{\top} - \lambda I \)</span> が逆行列を持つと（つまり正則だと）， <span class="math notranslate nohighlight">\( \boldsymbol{w}^{\top} = 0 \)</span> という自明解しか持たないことになってしまう．
よって，固有ベクトル <span class="math notranslate nohighlight">\( \boldsymbol{w}^{\top} \)</span> が0でない解を持つためには，<span class="math notranslate nohighlight">\( P^{\top} - \lambda I \)</span> が逆行列を持たないことが条件となる．
この条件は，行列式が0になることと等価であるので，</p>
<div class="math notranslate nohighlight">
\[
    |P^{\top} - \lambda I| = 0
\]</div>
<p>と表され，これを<strong>固有方程式</strong>と呼ぶ．</p>
</div>
</section>
</section>
<section id="id28">
<h3><span class="section-number">4.4.2. </span>マルコフ連鎖の例<a class="headerlink" href="#id28" title="Link to this heading">#</a></h3>
<section id="id29">
<h4>具体例<a class="headerlink" href="#id29" title="Link to this heading">#</a></h4>
<p>あるスポーツにおいて，Aチームの得点を状態0，Bチームの得点を状態1で表す．
Aチームが連続して得点する確率を0.8，Bチームが連続して得点する確率を0.7とすると，<a class="reference internal" href="#fig-markov-chain-2"><span class="std std-numref">図 4.2</span></a> のような状態遷移図が得られ，遷移確率行列は次のように与えられる：</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    P = \begin{pmatrix}
        0.8 &amp; 0.2 \\
        0.3 &amp; 0.7 
    \end{pmatrix}
\end{split}\]</div>
<p>この遷移確率行列から，例えば，最初（時刻0）にAチームが得点した場合の時刻<span class="math notranslate nohighlight">\( 2 \)</span>における状態ベクトルは</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \boldsymbol{w}_{2} = \boldsymbol{w}_{0}P^{2} = [1, 0] \begin{pmatrix}
        0.8 &amp; 0.2 \\
        0.3 &amp; 0.7 
    \end{pmatrix}^{2} = [0.68, 0.32]
\end{split}\]</div>
<p>となる．</p>
<p>定常分布は転置行列 <span class="math notranslate nohighlight">\( P^{\top} \)</span> の固有値1に対応する固有ベクトルとして求まる．
まずは，<span class="math notranslate nohighlight">\( P^{\top} \)</span> が固有値1を持つことを確かめるため，固有値方程式</p>
<div class="math notranslate nohighlight">
\[
    |P^{\top}-\lambda I| = 0
\]</div>
<p>を解いてみる（<span class="math notranslate nohighlight">\( I \)</span> は単位行列）．
この固有値方程式は</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{vmatrix}
        0.8-\lambda &amp; 0.3 \\
        0.2 &amp; 0.7-\lambda
    \end{vmatrix}
    = 0
\end{split}\]</div>
<p>となるのでこれを解くと，<span class="math notranslate nohighlight">\( \lambda_{1}=1 \)</span> と <span class="math notranslate nohighlight">\( \lambda_{2}=0.5 \)</span> が得られ，確かに固有値1を持つことが分かる．</p>
<p>次に，固有値1に対する固有ベクトルを求める．
関係式 <span class="math notranslate nohighlight">\( P^{\top}\boldsymbol{w}^{\top}=\boldsymbol{w}^{\top} \)</span> は</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{pmatrix}
        0.8 &amp; 0.3 \\
        0.2 &amp; 0.7 
    \end{pmatrix}
    \begin{pmatrix}
        w_{0} \\
        w_{1}
    \end{pmatrix}
    = \begin{pmatrix}
        w_{0} \\
        w_{1}
    \end{pmatrix}
\end{split}\]</div>
<p>と書けるので，これより <span class="math notranslate nohighlight">\( w_{1} = \frac{2}{3}w_{0} \)</span>　が得られる．
よって，確率の条件 <span class="math notranslate nohighlight">\( w_{0}+w_{1}=1 \)</span> を満たすような固有ベクトルは</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{pmatrix}
    w_{0}\\
    w_{1}
    \end{pmatrix}
    =
    \begin{pmatrix}
    0.6\\
    0.4
    \end{pmatrix}
\end{split}\]</div>
<p>と求まる．</p>
<figure class="align-default" id="fig-markov-chain-2">
<a class="reference internal image-reference" href="../_images/markov_chain_2.png"><img alt="../_images/markov_chain_2.png" src="../_images/markov_chain_2.png" style="height: 80px;" /></a>
<figcaption>
<p><span class="caption-number">図 4.2 </span><span class="caption-text">２状態マルコフ連鎖の状態遷移図</span><a class="headerlink" href="#fig-markov-chain-2" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="id30">
<h4>応用例<a class="headerlink" href="#id30" title="Link to this heading">#</a></h4>
<p>マルコフ連鎖は自然現象から社会現象に至るまで，様々な現象をモデル化するために用いられる．</p>
<ul class="simple">
<li><p>株価変動のモデル</p></li>
<li><p>言語生成のモデル</p></li>
<li><p>球技におけるパス回しのモデル</p></li>
</ul>
<p>また，具体的な現象のモデル以外にも多くの応用例がある．</p>
<ul class="simple">
<li><p>GoogleのPageRank</p></li>
<li><p>マルコフ連鎖モンテカルロ法</p></li>
</ul>
</section>
</section>
<section id="python">
<h3><span class="section-number">4.4.3. </span>Pythonによる実装<a class="headerlink" href="#python" title="Link to this heading">#</a></h3>
<p>以下のデータは，ある都市の30日間の天気を0（＝晴れ），1（＝曇），2（＝雨）の3つの状態で表したものである．</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>遷移確率行列の推定</strong></p>
<p>まず，遷移確率 <span class="math notranslate nohighlight">\( p_{ij} \)</span> を以下の式で推定する：</p>
<div class="math notranslate nohighlight">
\[
    p_{ij} = \frac{N_{ij}}{N_{i}}
\]</div>
<p>ここで，<span class="math notranslate nohighlight">\( N_{ij} \)</span> は状態 <span class="math notranslate nohighlight">\( i \)</span> から <span class="math notranslate nohighlight">\( j \)</span> への遷移回数，<span class="math notranslate nohighlight">\( N_{i} \)</span> は状態 <span class="math notranslate nohighlight">\( i \)</span> の出現回数である．</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 時刻kとk+1のデータをデータフレームに格納</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;t+1&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:]})</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t</th>
      <th>t+1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 遷移確率行列の推定</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t+1&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">)])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.66666667, 0.27777778, 0.05555556],
       [0.57142857, 0.28571429, 0.14285714],
       [0.25      , 0.25      , 0.5       ]])
</pre></div>
</div>
</div>
</div>
<p><strong>マルコフ連鎖の計算</strong></p>
<p>遷移確率行列 <span class="math notranslate nohighlight">\( P \)</span> が求まったら，任意の初期状態ベクトル <span class="math notranslate nohighlight">\( \boldsymbol{w}_{0} \)</span> と <span class="math notranslate nohighlight">\( P \)</span> との行列積を繰り返し計算すれば良い．
NumPy配列の行列積は <code class="docutils literal notranslate"><span class="pre">np.dot()</span></code> で計算できる．
今回の遷移確率行列の場合は，どんな初期状態ベクトルに対しても，最終的には同じ定常状態に収束することが確認できる．</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 初期状態分布</span>
<span class="n">w0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
<span class="n">w0</span> <span class="o">=</span> <span class="n">w0</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">w0</span><span class="p">)</span> <span class="c1"># 規格化</span>

<span class="c1"># マルコフ連鎖の計算</span>
<span class="n">W_all</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w0</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
    <span class="n">W_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">W_all</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span>
<span class="n">w</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.58064516, 0.27598566, 0.14336918])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">W_all</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$w_</span><span class="si">%s</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;時刻 $k$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;状態確率&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.0, 1.0)
</pre></div>
</div>
<img alt="../_images/15f55f759187e7eed066049dca227ac01de408b43d129bae1f771fdbbd77ee75.png" src="../_images/15f55f759187e7eed066049dca227ac01de408b43d129bae1f771fdbbd77ee75.png" />
</div>
</div>
</section>
<section id="id31">
<h3><span class="section-number">4.4.4. </span>演習問題<a class="headerlink" href="#id31" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>上の具体例で扱った2状態マルコフ連鎖について，定常状態の状態ベクトルを数値的に求めよ．</p></li>
<li><p>マルコフ連鎖の応用例について調べよ．</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chap_4"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../chap_3/3_curve_fitting.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">前へ</p>
        <p class="prev-next-title"><span class="section-number">3. </span>カーブフィッティング</p>
      </div>
    </a>
    <a class="right-next"
       href="../chap_5/5_diff_eq.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">次へ</p>
        <p class="prev-next-title"><span class="section-number">5. </span>微分方程式モデル</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> 目次
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">4.1. 乱数の生成</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">4.1.1. 一様乱数</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">線形合同法</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">より性能の良い一様乱数生成アルゴリズム</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">4.1.2. 任意の確率分布に従う乱数</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">逆関数法</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#box-muller">Box-Muller法（正規分布）</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">複雑な確率分布の場合</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">4.2. ベルヌーイ過程</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">4.2.1. 二項分布</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">4.2.2. ポアソン分布</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">4.2.3. 演習問題</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">4.3. 大数の法則と中心極限定理</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">4.3.1. 大数の法則</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">ベルヌーイ過程の場合</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">大数の法則（一般の場合）</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">4.3.2. 中心極限定理</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">ベルヌーイ分布の場合</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">指数分布の場合</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">4.3.3. サイコロを振る実験</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">4.4. マルコフ連鎖</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">4.4.1. マルコフ連鎖の定式化</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">遷移確率</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">状態ベクトル</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">マルコフ連鎖の定常状態</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">4.4.2. マルコフ連鎖の例</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">具体例</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">応用例</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python">4.4.3. Pythonによる実装</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">4.4.4. 演習問題</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  © Copyright 2023-present by 成塚拓真 (Takuma Narizuka). この講義ノートは<a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.ja">CC BY-NC-ND 4.0</a>の下に提供する．</a>ただし，コード部分は<a rel="license" href="https://opensource.org/licenses/MIT">MITライセンス</a>の下に提供する．

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>